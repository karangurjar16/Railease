{% extends "basic1.html" %} {% block nav1 %}
<ul id="nav-mobile" class="right hide-on-med-and-down">
  {% if request.user.is_authenticated %}
  <a
    class="nav-link nav-profile d-flex align-items-center pe-0"
    href="#"
    data-bs-toggle="dropdown"
  >
    <span class="d-none d-md-block dropdown-toggle ps-2">
      {{ request.user.username }}
    </span> </a
  ><!-- End Profile Image Icon -->
  <ul class="dropdown-menu dropdown-menu-end dropdown-menu-arrow profile">
    <li class="dropdown-header">
      <h6>{{ request.user.first_name }} {{ request.user.last_name }}</h6>
      <span>Web Designer</span>
    </li>
    <li>
      <hr class="dropdown-divider" />
    </li>
    <li>
      <a class="dropdown-item d-flex align-items-center" href="#">
        <i class="bi bi-person"></i>
        <span>My Profile</span>
      </a>
    </li>
    <li>
      <hr class="dropdown-divider" />
    </li>
    <li>
      <a
        class="dropdown-item d-flex align-items-center"
        href="users-profile.html"
      >
        <i class="bi bi-gear"></i>
        <span>Account Settings</span>
      </a>
    </li>
    <li>
      <hr class="dropdown-divider" />
    </li>
    <li>
      <a class="dropdown-item d-flex align-items-center" href="pages-faq.html">
        <i class="bi bi-question-circle"></i>
        <span>Need Help?</span>
      </a>
    </li>
    <li>
      <hr class="dropdown-divider" />
    </li>
    <li>
      <a
        class="dropdown-item d-flex align-items-center"
        href="{% url 'user_logout' %}"
      >
        <i class="bi bi-box-arrow-right"></i>
        <span>Sign Out</span>
      </a>
    </li>
  </ul>
  <!-- End Profile Dropdown Items -->
  {% else %}
  <a href="{% url 'user_login' %}">Login</a>
  {% comment %}
  <a href="{% url 'signup' %}">Signup</a>
  {% endcomment %} {% endif %}
</ul>
{% endblock %} {% block cont %}
<main id="main" class="main">
    <section class="section dashboard">
        <div class="row">
            <div class="col-lg-10">
                <div class="row">
                    <div class="col-12">
                        <div class="card">
                            <center>
                                <h5 class="card-title">Search Train</h5>
                            </center>
                            <div id="reportsChart"></div>
                            <div class="card-body">
                                <div class="search-bar">
                                    <form method="post" action="{% url 'u_search'%}">
                                        {% csrf_token %}
                                        <label for="query">Search by Train Number:</label>
                                        <input
                                            type="text"
                                            name="query"
                                            id="trainNumberInput"
                                            required
                                        />
                                        <div id="trainNumberSuggestions"></div>
                                        <p style="color:red">{{ message }}</p>
                                        <center>
                                            <button type="submit">
                                                <a>Search</a>
                                            </button>
                                        </center>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
</main>

<script>
    // Add JavaScript to handle train number suggestions
    const trainNumberInput = document.getElementById('trainNumberInput');
    const trainNumberSuggestions = document.getElementById('trainNumberSuggestions');

    trainNumberInput.addEventListener('input', function () {
        const inputText = this.value;
        if (inputText.length > 0) {
            // Make an AJAX request to fetch suggestions based on the inputText
            // You can use Django views to handle this AJAX request
            fetch(`/get_train_number_suggestions/?input=${inputText}`)
                .then(response => response.json())
                .then(data => {
                    // Update the dropdown with suggestions
                    trainNumberSuggestions.innerHTML = '';
                    data.suggestions.forEach(suggestion => {
                        const suggestionItem = document.createElement('div');
                        suggestionItem.textContent = suggestion;
                        suggestionItem.addEventListener('click', function () {
                            // Set the selected suggestion in the input field
                            trainNumberInput.value = suggestion;
                            // Clear the suggestions
                            trainNumberSuggestions.innerHTML = '';
                        });
                        trainNumberSuggestions.appendChild(suggestionItem);
                    });
                });
        } else {
            // Clear the suggestions if inputText is empty
            trainNumberSuggestions.innerHTML = '';
        }
    });
</script>


{%endblock%}
